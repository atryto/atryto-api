version: '3'

services:

  mysql:
    image: mysql:5.7
    ports:
        - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: p4SSW0rd
      MYSQL_DATABASE: exchange
      MYSQL_USER: dbuser
      MYSQL_PASSWORD: dbp4ss
    
  backend:
    image: atryto-api
    ports:
        - "3000:3000"
    depends_on:
        - mysql
    environment:
      NODE_ENV: development
      DATABASE_HOST: mysql
      DATABASE_USER: dbuser
      DATABASE_PASSWORD: dbp4ss
      DATABASE_NAME: exchange
      DATABASE_PORT: 3306
      WAIT_HOSTS: mysql:3306
      FLYWAY_URL: jdbc:mysql://mysql:3306 
      FLYWAY_USER: root
      FLYWAY_PASSWORD: p4SSW0rd
      FLYWAY_SCHEMAS: exchange
  frontend:
    image: atryto-frontend
    ports:
      - "8080:8080"
    depends_on:
      - backend
    environment:
      NODE_ENV: development
      API_URL: backend:3000
      WAIT_HOSTS: backend:3000